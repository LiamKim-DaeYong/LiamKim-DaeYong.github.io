<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="영속성 컨텍스트의 특징" /><meta property="og:locale" content="en" /><meta name="description" content="영속성 컨텍스트의 이점 영속성 컨텍스트가 엔티티를 관리하는 것은 다음과 같은 이점이 있다." /><meta property="og:description" content="영속성 컨텍스트의 이점 영속성 컨텍스트가 엔티티를 관리하는 것은 다음과 같은 이점이 있다." /><link rel="canonical" href="https://liamkim-daeyong.github.io/posts/jpa-03/" /><meta property="og:url" content="https://liamkim-daeyong.github.io/posts/jpa-03/" /><meta property="og:site_name" content="D.Yong Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-24T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="영속성 컨텍스트의 특징" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-30T17:46:07+09:00","datePublished":"2022-05-24T00:00:00+09:00","description":"영속성 컨텍스트의 이점 영속성 컨텍스트가 엔티티를 관리하는 것은 다음과 같은 이점이 있다.","headline":"영속성 컨텍스트의 특징","mainEntityOfPage":{"@type":"WebPage","@id":"https://liamkim-daeyong.github.io/posts/jpa-03/"},"url":"https://liamkim-daeyong.github.io/posts/jpa-03/"}</script><title>영속성 컨텍스트의 특징 | D.Yong Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="D.Yong Blog"><meta name="application-name" content="D.Yong Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">D.Yong Blog</a></div><div class="site-subtitle font-italic">소프트웨어 장인을 꿈꾸는<br>백앤드 개발자</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/LiamKim-DaeYong" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['liamkim1018','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>영속성 컨텍스트의 특징</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>영속성 컨텍스트의 특징</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1653318000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 24, 2022 </em> </span> <span> Updated <em class="" data-ts="1653900367" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 30, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/LiamKim-DaeYong">DaeYongKim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1105 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="영속성-컨텍스트의-이점">영속성 컨텍스트의 이점</h1><p>영속성 컨텍스트가 엔티티를 관리하는 것은 다음과 같은 이점이 있다.</p><ul><li>1차 캐시<li>동일성 보장<li>트랜잭션을 지원하는 쓰기 지연<li>변경 감지<li>지연 로딩</ul><h2 id="1차-캐시"><span class="mr-2">1차 캐시</span><a href="#1차-캐시" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>영속성 컨텍스트는 내부에 캐시를 가지고 있는데 이를 <code class="language-plaintext highlighter-rouge">1차 캐시</code>라 하고 영속성 컨텍스트가 관리하는 엔티티들은 모두 이곳에 저장된다.</p><ul><li><code class="language-plaintext highlighter-rouge">em.persist(member)</code>를 통해 영속성 컨텍스트의 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에 엔티티 저장<li>영속성 컨텍스트 내부에 <code class="language-plaintext highlighter-rouge">@Id로 매핑한 식별자</code>를 키로 가지고 <code class="language-plaintext highlighter-rouge">엔티티 인스턴스</code>를 값으로 가지는 Map이 존재</ul><p><img data-src="https://liamkim-daeyong.github.io/assets/img/post/jpa/03/img01.png" alt="" data-proofer-ignore></p><h3 id="엔티티-조회---1차-캐시에서-조회"><span class="mr-2">엔티티 조회 - 1차 캐시에서 조회</span><a href="#엔티티-조회---1차-캐시에서-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">em.find()</code>를 통해 엔티티를 조회 시 JPA는 우선 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에서 식별자 값으로 엔티티를 찾는다. 만약 찾고자 하는 엔티티가 있으면 데이터베이스를 조회하지 않고 메모리에 있는 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에서 엔티티를 조회하여 반환한다.</p><ol><li><code class="language-plaintext highlighter-rouge">1차 캐시</code> 조회<li><code class="language-plaintext highlighter-rouge">1차 캐시</code>에서 엔티티 반환 (1차 캐시에 엔티티가 있을 시)</ol><p><img data-src="https://liamkim-daeyong.github.io/assets/img/post/jpa/03/img02.png" alt="" data-proofer-ignore></p><h3 id="엔티티-조회---데이터-베이스에서-조회"><span class="mr-2">엔티티 조회 - 데이터 베이스에서 조회</span><a href="#엔티티-조회---데이터-베이스에서-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>만약 엔티티가 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에 없으면 엔티티 매니저는 데이터 베이스에서 값을 조회한다. 그리고 조회된 값을 통해 엔티티를 생성하고 이를 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에 저장한 후 <code class="language-plaintext highlighter-rouge">영속 상태</code>의 엔티티를 반환한다.</p><ol><li><code class="language-plaintext highlighter-rouge">1차 캐시</code> 조회<li>데이터 베이스 조회 (1차 캐시에 엔티티가 없을 시)<li><code class="language-plaintext highlighter-rouge">1차 캐시</code>에 엔티티 저장<li>엔티티 반환 (영속 상태)</ol><p><img data-src="https://liamkim-daeyong.github.io/assets/img/post/jpa/03/img03.png" alt="" data-proofer-ignore></p><h2 id="동일성-보장"><span class="mr-2">동일성 보장</span><a href="#동일성-보장" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>JPA는 영속성 컨텍스트가 관리하는 영속 상태의 엔티티에 대해서 <strong>동일성을 보장</strong>해 준다. 이는 영속성 컨텍스트 내부의 1차 캐시가 엔티티를 Map으로 캐싱하고 있기 때문에 같은 식별자(@Id)에 대해서 항상 같은 인스턴스에 접근하게 되므로 동일성이 보장된다.</p><h2 id="트랜잭션을-지원하는-쓰기-지연"><span class="mr-2">트랜잭션을 지원하는 쓰기 지연</span><a href="#트랜잭션을-지원하는-쓰기-지연" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>엔티티 매니저는 트랜잭션을 커밋하기 직전까지 데이터베이스의 엔티티를 저장하지 않는다.(트랜잭션 커밋직전까지 Insert Query를 보내지 않는다.)</p><p><code class="language-plaintext highlighter-rouge">em.persist()</code>를 통해 엔티티를 <code class="language-plaintext highlighter-rouge">1차 캐시</code>에 저장하고 <code class="language-plaintext highlighter-rouge">Insert Query</code>를 생성하여 <code class="language-plaintext highlighter-rouge">쓰기지연 SQL 저장소</code>에 저장한다. 트랜잭션이 커밋되는 시점에 <code class="language-plaintext highlighter-rouge">쓰기지연 SQL 저장소</code>의 모인 쿼리들을 데이터베이스에 보낸다. 마지막으로 실제 데이터베이스 트랜잭션이 커밋된다.</p><ol><li><code class="language-plaintext highlighter-rouge">1차 캐시</code>에 엔티티 저장<li><code class="language-plaintext highlighter-rouge">Insert Query</code> 생성 후 <code class="language-plaintext highlighter-rouge">쓰기지연 SQL 저장소</code>에 쿼리 저장<li>트랜잭션 커밋 시 <code class="language-plaintext highlighter-rouge">쓰기지연 SQL 저장소</code>에 저장된 쿼리들을 데이터베이스로 전송<li>데이터베이스 트랜잭션 커밋</ol><p><img data-src="https://liamkim-daeyong.github.io/assets/img/post/jpa/03/img04.png" alt="" data-proofer-ignore></p><h2 id="변경감지"><span class="mr-2">변경감지</span><a href="#변경감지" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>JPA에서는 <code class="language-plaintext highlighter-rouge">변경감지(dirty checking)</code> 기능을 제공하고 이를 통해 엔티티의 값을 변경할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
<span class="nc">EntityTransaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="n">transaction</span><span class="o">.</span><span class="na">begin</span><span class="o">()</span> <span class="c1">// 트랜잭션 시작</span>

<span class="c1">// 영속 엔티티 조회</span>
<span class="nc">Member</span> <span class="n">memberA</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"memberA"</span><span class="o">);</span>

<span class="c1">// 영속 엔티티 데이터 수정</span>
<span class="n">memberA</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"hi"</span><span class="o">);</span>
<span class="n">memberA</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>

<span class="n">transaction</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span> <span class="c1">// 트랜잭션 커밋</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">변경감지(dirty checking)</code>는 위의 코드와 같이 영속상태의 엔티티를 조회 후 <code class="language-plaintext highlighter-rouge">setter</code>를 통해 값을 변경하면 트랜잭션이 커밋될 때 변경사항을 데이터 베이스에 자동으로 반영하는 기능이다.</p><p>JPA 영속성 컨텍스트 내부에 엔티티의 최초 상태를 복사하여 저장해두는데 이를 <strong>스냅샷</strong>이라 한다. 트랜잭션이 커밋되면 스냅샷과 엔티티의 값을 비교하여 데이터 베이스에 변경사항을 반영한다.</p><p><img data-src="https://liamkim-daeyong.github.io/assets/img/post/jpa/03/img05.png" alt="" data-proofer-ignore></p><h1 id="참고">참고</h1><ul><li><a href="https://www.inflearn.com/course/ORM-JPA-Basic/dashboard">인프런 자바 ORM 표준 JPA 프로그래밍 - 기본편(김영한)</a><li><a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&amp;ejkGb=KOR&amp;barcode=9788960777330">자바 ORM 표준 JPA 프로그래밍</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/jpa/'>JPA</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/jpa/" class="post-tag no-text-decoration" >JPA</a> <a href="/tags/%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/" class="post-tag no-text-decoration" >영속성 컨텍스트</a> <a href="/tags/1%EC%B0%A8-%EC%BA%90%EC%8B%9C/" class="post-tag no-text-decoration" >1차 캐시</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EC%98%81%EC%86%8D%EC%84%B1+%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98+%ED%8A%B9%EC%A7%95+-+D.Yong+Blog&url=https%3A%2F%2Fliamkim-daeyong.github.io%2Fposts%2Fjpa-03%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EC%98%81%EC%86%8D%EC%84%B1+%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98+%ED%8A%B9%EC%A7%95+-+D.Yong+Blog&u=https%3A%2F%2Fliamkim-daeyong.github.io%2Fposts%2Fjpa-03%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fliamkim-daeyong.github.io%2Fposts%2Fjpa-03%2F&text=%EC%98%81%EC%86%8D%EC%84%B1+%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98+%ED%8A%B9%EC%A7%95+-+D.Yong+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-09/">필드와 컬럼 캐핑</a><li><a href="/posts/jpa-10/">단방향 연관관계</a><li><a href="/posts/jpa-05/">준영속 상태</a><li><a href="/posts/jpa-06/">병합(Merge)</a><li><a href="/posts/jpa-07/">엔티티 매핑</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/srping/">Srping</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/mvc/">MVC</a> <a class="post-tag" href="/tags/applicationcontext/">ApplicationContext</a> <a class="post-tag" href="/tags/1%EC%B0%A8-%EC%BA%90%EC%8B%9C/">1차 캐시</a> <a class="post-tag" href="/tags/entity-mapping/">Entity Mapping</a> <a class="post-tag" href="/tags/%EB%B9%88-%EC%83%9D%EB%AA%85%EC%A3%BC%EA%B8%B0/">빈 생명주기</a> <a class="post-tag" href="/tags/%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/">상속관계 매핑</a> <a class="post-tag" href="/tags/%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/">영속성 컨텍스트</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/jpa-04/"><div class="card-body"> <em class="small" data-ts="1655737200" data-df="ll" > Jun 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>플러시</h3><div class="text-muted small"><p> 플러시 (Flush) 플러시는 영속성 컨텍스트의 변경 내용을 데이터베이스에 반영하는 것을 말하고 아래의 경우에 발생된다. Transaction Commit 발생 EntityManager의 flush 메서드 호출 JPQL 쿼리 실행 동작 과정 플러시가 발생되면 변경감지를 통해 영속성 컨텍스트 내에 관리되는 엔티티들을 스냅샷과 비교하여 수...</p></div></div></a></div><div class="card"> <a href="/posts/jpa-05/"><div class="card-body"> <em class="small" data-ts="1659279600" data-df="ll" > Aug 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>준영속 상태</h3><div class="text-muted small"><p> 준영속 상태 영속성 컨테스트가 관리하는 영속 상태의 엔티티가 영속성 컨텍스트에서 분리된(detached) 것을 준영속 상태라 한다. 따라서 준영속 상태가 된 엔티티는 영속성 컨텍스트가 제공하는 기능을 사용할 수 없게된다. 준영속 상태 만들기 영속 상태의 엔티티를 준영속 상태로 만드는 방법은 크게 3가지가 있다. em.detach(entity):...</p></div></div></a></div><div class="card"> <a href="/posts/jpa-06/"><div class="card-body"> <em class="small" data-ts="1659279600" data-df="ll" > Aug 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>병합(Merge)</h3><div class="text-muted small"><p> 병합 준영속 상태의 엔티티를 다시 영속 상태로 변경하려면 병합을 사용하면 된다. merge() 메소드는 준영속 상태의 엔티티를 받아서 그 정보로 새로운 영속 상태의 엔티티를 반환한다. 준영속 병합 예제 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/jpa-02/" class="btn btn-outline-primary" prompt="Older"><p>엔티티 생명주기(Entity LifeCycle)</p></a> <a href="/posts/jpa-04/" class="btn btn-outline-primary" prompt="Newer"><p>플러시</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://liamkim-daeyong.github.io/posts/jpa-03/'; this.page.identifier = '/posts/jpa-03/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://liamkim-daeyong-github-io-1.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/LiamKim-DaeYong">DaeYongKim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/srping/">Srping</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/mvc/">MVC</a> <a class="post-tag" href="/tags/applicationcontext/">ApplicationContext</a> <a class="post-tag" href="/tags/1%EC%B0%A8-%EC%BA%90%EC%8B%9C/">1차 캐시</a> <a class="post-tag" href="/tags/entity-mapping/">Entity Mapping</a> <a class="post-tag" href="/tags/%EB%B9%88-%EC%83%9D%EB%AA%85%EC%A3%BC%EA%B8%B0/">빈 생명주기</a> <a class="post-tag" href="/tags/%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/">상속관계 매핑</a> <a class="post-tag" href="/tags/%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/">영속성 컨텍스트</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
